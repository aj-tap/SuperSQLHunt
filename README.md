# SuperSQLHunt

-----

## Purpose

`SuperSQLHunt` is a centralized, community-driven repository for detection rules based on the SuperSQL query syntax.

These rules are designed to be lightweight, portable, and compatible with text-based pipelines (like `grep`), enabling them to be "piggybacked" into other security tools. The primary goal is to provide a common, SQL-style language for detection and correlation across diverse datasets, including system logs, cloud monitoring data, and OSINT datasource.

## Features

  * **Fast, Searchable UI:** Instantly search and filter all rules by title, tag, description, author, or syntax.
  * **Clickable Tags:** Click any rule's tag to automatically populate the search bar and filter the list.
  * **Static & Portable:** The entire project is a static site, making it fast, simple, and easy to host or fork.

## Rule Structure

Rules are simple `.yaml` files with the following structure. Here is an example from `_rules/cobalt-strike.yaml`:

```yaml
id: d2e8f1c0-a4b3-4f1e-9d2c-8a1b5c2d3e4f
title: detects Cobalt Strike Hash
description: Identifies go 1.15.2 linux/amd64 jarm hash
author: aj-tap
syntax: from shodan | grep('29d21b20d29d29d21c41d21b21b41d494e0df9532e75299f15ba73156cee38',this)
tags:
  - shodan
  - c2
```

Field Descriptions
- id: A unique UUID for the rule. This is automatically generated by the submission page.
- title: A short, descriptive name for what the rule detects.
- description: A clear, concise explanation of the rule's purpose, what it finds, and any relevant context.
- author: The name or handle of the person who created the rule.
- syntax: The core SuperSQL logic used for detection. This is the exact query that will be run.
- tags: A list of keywords (in - tag format) to help with filtering and searching. These are comma-separated in the submission form.
- source: The original source of the intelligence or detection logic (e.g., a blog post URL, an intel feed).

## SuperSQL Syntax Best Practices

* **Go Beyond `grep`:** The SuperSQL syntax is not limited to `grep` patterns. You can create many powerful patterns to help navigate and structure data. For a complete guide, see the [official documentation](https://superdb.org/docs/language/overview/).
* **Embrace the Pipeline:** The syntax is built around the `|` (pipe) operator. Start with a data source (e.g., `from shodan`, `from logs`) and pipe the results to one or more functions.
* **Keep Rules Atomic:** A rule should do one thing well. Focus on detecting a single, specific indicator (e.g., one JARM hash, one ASN, a specific command). This makes rules portable, testable, and easy to "piggyback" onto any tool.
* **Correlate, Don't Compute:** The syntax is optimized for correlationâ€”matching data from one source (like a log) against a piece of data from another.
* **Keep it Simple:** Write the most straightforward, readable query possible. If a rule is too complex, it's often better to split it into two simpler, atomic rules.

## How to Contribute to the Rules

1.  Navigate to the **[Submit New Rule](https://supersqlhunt.shinkensec.com/submit.html)** page.
2.  Fill out the form with your rule's details. A unique ID will be generated for you.
3.  Click the **"Submit Rule to GitHub"** button.
4.  This will automatically open a new GitHub page in your browser with your rule formatted as a `.yaml` file, ready for submission.
5.  Just follow the on-screen prompts on GitHub to "Propose new file". This will create a pull request for the project maintainers to review and approve.